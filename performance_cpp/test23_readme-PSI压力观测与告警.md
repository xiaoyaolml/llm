# test23：PSI 压力观测与轻量告警（Linux）

## 定位

本专题作为 `test10` 的实战补充，聚焦 Linux Pressure Stall Information（PSI）在生产观测中的最小闭环：
- 采集 `/proc/pressure/cpu|memory|io`
- 按秒输出 `some/full avg10`
- 基于阈值给出轻量告警提示

## 为什么补这个主题

`test10` 已讲解 OOM、调度与内存机制，但在“如何将这些机制转为可执行观测信号”方面还可更实操。PSI 恰好是连接内核压力与应用治理（限流、降级、扩缩容）的关键指标。

## 运行

```bash
g++ -std=c++17 -O2 -pthread -o test23 test23.cpp && ./test23
```

## 输出示例

- `some.avg10`：过去 10 秒内，至少一个任务被该资源阻塞的时间占比。
- `full.avg10`：过去 10 秒内，所有任务都被该资源阻塞的时间占比。

当 `some.avg10 >= 10%` 或 `full.avg10 >= 1%` 时，示例会输出告警提示。

## 工程注意

- 阈值应按业务 SLO 调整，不建议直接照搬。
- 建议与吞吐、P99 延迟、错误率联动，而不是只看 PSI。
- 可进一步结合 cgroup 维度 PSI（容器级）实现更细粒度治理。

## 与现有文件关系

- `test10.cpp`：内核机制全景与理论。
- `test23.cpp`：将机制映射为“可采集、可判断”的运行时信号。
